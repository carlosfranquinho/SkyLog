<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkyLog – Um olhar pousado no céu</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header>
    <h1>SkyLog – Um olhar pousado no céu</h1>
  </header>

  <main class="painel">

    <!-- Última hora (coluna esquerda) -->
    <section id="ultima-hora">
      <h2>Na última hora...</h2>
      <ul id="ultima-hora-lista"></ul>
    </section>

    <!-- Coluna da direita: mapa + listas -->
    <div id="painel-direita">
      <section id="rotas">
        <h2>Mapa de rotas</h2>
        <canvas id="mapa">[Mapa de rotas]</canvas>
      </section>

      <div id="coluna-lateral">
        <div id="top-paises">
          <h2>Top Países</h2>
          <ul id="top-paises-lista"></ul>
        </div>

        <div id="top-companhias">
          <h2>Top Companhias</h2>
          <ul id="top-companhias-lista"></ul>
        </div>
      </div>
    </div>

  </main>

  <script>
    async function carregarPainel() {
      try {
        const resp = await fetch("painel.json");
        const dados = await resp.json();

        // Na última hora...
        const ulHora = document.getElementById("ultima-hora-lista");
        dados.ultima_hora.forEach(v => {
          const dt = new Date(v.hora + "Z");
          const opt = {
            hour: "2-digit",
            minute: "2-digit",
            hour12: false,
            timeZone: "Europe/Lisbon",
          };
          const hm = new Intl.DateTimeFormat("pt-PT", opt)
            .format(dt)
            .replace(":", "h") + "m";
          ulHora.innerHTML += `
            <li>
              <strong>${v.chamada || v.hex}</strong> – às ${hm}
              ${v.alt ? `– Alt: ${v.alt} ft` : ""}
              ${v.vel ? `– Vel: ${v.vel} kt` : ""}
              ${v.dist ? `– Dist: ${v.dist} km` : ""}
            </li>`;
        });

        // Top Países
        const ulPaises = document.getElementById("top-paises-lista");
        dados.top_paises.forEach(p => {
          ulPaises.innerHTML += `<li>${p.bandeira || ""} ${p.pais}: ${p.total} aviões</li>`;
        });

        // Top Companhias
        const ulCias = document.getElementById("top-companhias-lista");
        dados.top_companhias.forEach(c => {
          ulCias.innerHTML += `<li>${c.cia}: ${c.total} voos</li>`;
        });

        // Mapa (placeholder)
        const canvas = document.getElementById("mapa");
        const ctx = canvas.getContext("2d");
        ctx.fillStyle = "#888";
        ctx.font = "16px sans-serif";
        ctx.fillText("Mapa de rotas (por implementar)", 20, 100);

      } catch (e) {
        console.error("Erro ao carregar painel:", e);
      }
    }

    carregarPainel();
  </script>
</body>
</html>
